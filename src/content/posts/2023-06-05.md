---
isDraft: false
title: 300ms Faster Reducing Wikipedia's Total Blocking Time
description: 300ms Wikipedia ã® TBT ã‚’æ”¹å–„ã—ãŸè©±
pubDate: 2023-06-05
tags: ["web", "TBT"]
---

## [300ms Faster: Reducing Wikipedia's Total Blocking Time](https://www.nray.dev/blog/300ms-faster-reducing-wikipedias-total-blocking-time/)

- 300ms Wikipedia ã® TBT ã‚’æ”¹å–„ã—ãŸè©±
  - TBT ã‚’ 50%æ”¹å–„
    - FID ã®è©±
    - 600ms ç§’ã® js ã®ã‚¿ã‚¹ã‚¯ã®é–“ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ããŸã¨ãã¯ï¼Ÿ
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ 100ms ä»¥ä¸Šã‹ã‹ã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’é…ã„ã¨èªè­˜ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
    - TBT ã¨ã¯ï¼Ÿ
      - 50ms ä»¥ä¸Šã‹ã‹ã‚‹ã‚¿ã‚¹ã‚¯ã®åˆè¨ˆæ™‚é–“
    - ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã§ã¯ã€200ms æœªæº€ã§ã‚ã‚‹ã“ã¨ã‚’ Google ã¯æ¨å¥¨
  - çŸ­ç¸®ã™ã‚‹æ–¹æ³•
    - FCP ã¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã¾ã§ã®ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã®ä½œæ¥­ã‚’æ¸›ã‚‰ã™
    - é•·ã„ã‚¿ã‚¹ã‚¯ã¯ 50ms ã‚’è¶…ãˆãªã„çŸ­ã„ã‚¿ã‚¹ã‚¯ã«åˆ†å‰²
    - ğŸ¤” ã“ã®ã‚ãŸã‚Šã«ã¤ã„ã¦ä»¥å‰ã®è¨˜äº‹ã«ã¾ã¨ã‚ãŸã®ã§ãã‚Œã‚’å‚ç…§
    - 1. ä¸è¦ãª JS ã‚’å‰Šé™¤
      - ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–ã£ãŸã‚‰ã€ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™»éŒ²ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒé•·ãã€ãã—ã¦ä¸è¦ã ã£ãŸ
      - å˜ç´”ã«å‰Šé™¤ã—ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ 200ms è¿‘ãé–‹æ”¾ã§ããŸ
        - ğŸ¤” ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã«ã‚‚æ™®é€šã«å‰Šé™¤ã§ãã‚‹ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Šãã†ã§ç¬‘ãˆãªã„
    - 2. æ—¢å­˜ã® js ã®æœ€é©åŒ–
      - `initMediaViewer` ã¨ã„ã†ã‚µãƒ ãƒã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ“ãƒ¥ãƒ¼ã‚¢ãŒé–‹ãã‚ˆã†ã«ã€ãã‚Œãã‚Œã®ã‚µãƒ ãƒã‚¤ãƒ«ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç™»éŒ²ã™ã‚‹é–¢æ•°ãŒ 100ms ã‹ã‹ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸ
      - ç”»åƒã®å¤šã„ãƒšãƒ¼ã‚¸ã§ã¯ TBT ã®å¢—åŠ ãŒè¦‹è¾¼ã¾ã‚Œã‚‹
      - `event delegation` ã‚’ä½¿ã£ã¦è§£æ±ºã™ã‚‹
        - ãã‚Œãã‚Œã®è¦ç´ ã« `onClick` ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç™»éŒ²ã™ã‚‹ã®ã§ã¯ãªãã€è¦ªè¦ç´ ã«ä¸€ã¤ã ã‘è¨­å®šã— `ev.target` ã§ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸè¦ç´ ãŒå¯¾è±¡ã®è¦ç´ ã§ã‚ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
        - ğŸ¤” React ã¯ï¼Ÿ
          - å®Ÿéš›ã«è¦ç´ ã« `onClick` ã‚’è¨­å®šã™ã‚‹ã®ã§ã¯ãªãã€ãƒ«ãƒ¼ãƒˆè¦ç´ ã«è¨­å®šã•ã‚Œã‚‹
            - [React v17.0 Release Candidate: æ–°æ©Ÿèƒ½ã€Œãªã—ã€ â€“ React Blog](https://ja.legacy.reactjs.org/blog/2020/08/10/react-v17-rc.html#changes-to-event-delegation)
          - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã†åˆ©ç‚¹ãŒã“ã®ã‚ãŸã‚Šã®è‡ªå‹•çš„ãªæœ€é©åŒ–ã«ã‚ã‚‹ã¨å€‹äººçš„ã«ã¯æ€ã†
  - ã¾ã¨ã‚ã¨ã—ã¦ã€ä¸€è¦‹å°ã•ãªå¤‰æ›´ã§ã‚ã£ã¦ã‚‚ã€Web ã‚µã‚¤ãƒˆå…¨ä½“ã«å¤§ããªå½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã¨è¿°ã¹ã¦ã„ã‚‹
    - ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹è¤‡é›‘ã§åºƒç¯„ãªå¤‰æ›´ãŒã„ã¤ã‚‚å¿…è¦ã§ã¯ãªã„ã¨ã„ã†ç¤ºå”†

## ãã®ä»–

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Modern HTML has many performance controls:<br><br>ğŸ”‘ Prioritize a key image: &lt;img fetchpriority=high&gt;<br>ğŸ’¤ Lazy-load images: &lt;img loading=lazy&gt;<br>ğŸŒ Warm connections to origins: rel=preconnect<br>ğŸ• Fetch late-found resources: rel=preload<br>â­ï¸ Fetch next-page navigations: rel=prefetch <a href="https://t.co/tbpwChnskn">pic.twitter.com/tbpwChnskn</a></p>&mdash; Addy Osmani (@addyosmani) <a href="https://twitter.com/addyosmani/status/1665423882914787328?ref_src=twsrc%5Etfw">June 4, 2023</a></blockquote>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Introducing Headline Balancing, available in Chromium M114! Better, yummy typography!<a href="https://t.co/efGjcpI7N9">https://t.co/efGjcpI7N9</a></p>&mdash; Nicole Sullivan (@stubbornella) <a href="https://twitter.com/stubbornella/status/1663588807126695939?ref_src=twsrc%5Etfw">May 30, 2023</a></blockquote>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Can you believe these slides are full page loads to completely new HTML pagesâ€½<a href="https://twitter.com/hashtag/smashingconf?src=hash&amp;ref_src=twsrc%5Etfw">#smashingconf</a><a href="https://t.co/AqRbrOM9xG">https://t.co/AqRbrOM9xG</a><br>^ try it with Canary and enable the flag chrome://flags/<a href="https://twitter.com/hashtag/view?src=hash&amp;ref_src=twsrc%5Etfw">#view</a>-transition-on-navigation<br><br>what. rad. tech. ğŸ¤¯ <a href="https://t.co/ltJo66n1hD">pic.twitter.com/ltJo66n1hD</a></p>&mdash; Adam Argyle (@argyleink) <a href="https://twitter.com/argyleink/status/1661800757304381443?ref_src=twsrc%5Etfw">May 25, 2023</a></blockquote>

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
